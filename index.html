<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NFT Gallery - 3D Carousel</title>

<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --neon-purple: #8b5cf6;
  --neon-cyan: #00f5ff;
  --neon-pink: #ff006e;
  --dark-bg: #0a0e1a;
  --dark-card: #151925;
}

body {
  font-family: 'Space Grotesk', sans-serif;
  background: #0a0e1a;
  color: white;
  overflow-x: hidden;
  min-height: 100vh;
}

/* ==================== ANIMATED BACKGROUND ==================== */
.animated-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
  background: radial-gradient(ellipse at top, #1a1f3a 0%, #0a0e1a 50%);
}

.grid-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: 
    linear-gradient(rgba(139, 92, 246, 0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(139, 92, 246, 0.1) 1px, transparent 1px);
  background-size: 50px 50px;
  z-index: 1;
  pointer-events: none;
  opacity: 0.3;
}

/* ==================== HEADER ==================== */
.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;
  padding: 20px 40px;
  background: rgba(10, 14, 26, 0.8);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(139, 92, 246, 0.2);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
}

.logo-text {
  font-size: 24px;
  font-weight: 800;
  background: linear-gradient(135deg, var(--neon-purple), var(--neon-cyan));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.nav-actions {
  display: flex;
  gap: 12px;
  align-items: center;
}

.login-btn {
  font-size: 13px;
  padding: 8px 16px;
  border-radius: 999px;
  border: 1px solid rgba(139, 92, 246, 0.3);
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(10px);
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.2s;
  font-family: 'Space Grotesk', sans-serif;
  font-weight: 600;
}

.login-btn:hover {
  background: rgba(139, 92, 246, 0.2);
  border-color: var(--neon-purple);
  box-shadow: 0 0 30px rgba(139, 92, 246, 0.4);
  transform: translateY(-2px);
}

.login-btn.mint-btn {
  background: linear-gradient(135deg, #ef4444, #dc2626);
  border-color: #ef4444;
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.25);
  animation: subtle-pulse-red 2s ease-in-out infinite;
}

.login-btn.mint-btn:hover {
  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
}

@keyframes subtle-pulse-red {
  0%, 100% {
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.25);
  }
  50% {
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.45);
  }
}

.avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #14b8a6, #10b981);
}

/* ==================== TOP NAV BUTTONS ==================== */
.top-nav {
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-bottom: 40px;
}

.top-nav-btn {
  padding: 8px 20px;
  font-size: 16px;
  border-radius: 999px;
  border: 1px solid rgba(139, 92, 246, 0.3);
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(10px);
  color: white;
  cursor: pointer;
  transition: 0.2s;
  font-family: 'Space Grotesk', sans-serif;
  font-weight: 600;
}

.top-nav-btn:hover { 
  background: rgba(139, 92, 246, 0.2);
  border-color: var(--neon-purple);
  transform: translateY(-2px);
}

.top-nav-btn.active {
  background: linear-gradient(135deg, var(--neon-purple), var(--neon-cyan));
  color: white;
  border-color: var(--neon-purple);
}

/* ==================== MAIN CONTENT ==================== */
.main-content {
  position: relative;
  z-index: 10;
  padding-top: 100px;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.gallery-title {
  font-size: 48px;
  font-weight: 800;
  text-align: center;
  background: linear-gradient(135deg, var(--neon-purple), var(--neon-cyan));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 60px;
}

/* ==================== 3D CAROUSEL ==================== */
.carousel-container {
  position: relative;
  width: 100%;
  height: 600px;
  perspective: 1000px;
  margin-bottom: 80px;
}

.carousel-wrapper {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  animation: rotate-showcase 80s linear infinite;
}

.carousel-wrapper.paused {
  animation-play-state: paused;
}

.carousel-wrapper:hover {
  animation-play-state: paused;
}

@keyframes rotate-showcase {
  from { transform: rotateY(0deg); }
  to { transform: rotateY(360deg); }
}

.nft-card-3d {
  position: absolute;
  width: 110px;
  height: 110px;
  left: 50%;
  top: 50%;
  transform-origin: center;
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid rgba(139, 92, 246, 0.3);
  box-shadow: 0 0 15px rgba(139, 92, 246, 0.4);
  transition: all 0.3s ease;
  cursor: pointer;
  background: rgba(21, 25, 37, 0.8);
}

.nft-card-3d:hover {
  border-color: var(--neon-cyan);
  box-shadow: 0 0 50px rgba(0, 245, 255, 0.6);
  transform: scale(1.1) !important;
}

.nft-card-3d img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: none;
}

.nft-card-3d img.loaded {
  display: block;
}

.nft-card-placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 8px;
  text-align: center;
  background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(0, 245, 255, 0.1));
}

.nft-card-placeholder.hidden {
  display: none;
}

.placeholder-name {
  font-size: 9px;
  font-weight: 700;
  color: var(--neon-cyan);
  line-height: 1.2;
  text-shadow: 0 0 10px rgba(0, 245, 255, 0.5);
}

/* Position cards in circle - 20 items - LARGE RADIUS to prevent overlap */
.nft-card-3d:nth-child(1) { transform: translate(-50%, -50%) rotateY(0deg) translateZ(400px); }
.nft-card-3d:nth-child(2) { transform: translate(-50%, -50%) rotateY(18deg) translateZ(400px); }
.nft-card-3d:nth-child(3) { transform: translate(-50%, -50%) rotateY(36deg) translateZ(400px); }
.nft-card-3d:nth-child(4) { transform: translate(-50%, -50%) rotateY(54deg) translateZ(400px); }
.nft-card-3d:nth-child(5) { transform: translate(-50%, -50%) rotateY(72deg) translateZ(400px); }
.nft-card-3d:nth-child(6) { transform: translate(-50%, -50%) rotateY(90deg) translateZ(400px); }
.nft-card-3d:nth-child(7) { transform: translate(-50%, -50%) rotateY(108deg) translateZ(400px); }
.nft-card-3d:nth-child(8) { transform: translate(-50%, -50%) rotateY(126deg) translateZ(400px); }
.nft-card-3d:nth-child(9) { transform: translate(-50%, -50%) rotateY(144deg) translateZ(400px); }
.nft-card-3d:nth-child(10) { transform: translate(-50%, -50%) rotateY(162deg) translateZ(400px); }
.nft-card-3d:nth-child(11) { transform: translate(-50%, -50%) rotateY(180deg) translateZ(400px); }
.nft-card-3d:nth-child(12) { transform: translate(-50%, -50%) rotateY(198deg) translateZ(400px); }
.nft-card-3d:nth-child(13) { transform: translate(-50%, -50%) rotateY(216deg) translateZ(400px); }
.nft-card-3d:nth-child(14) { transform: translate(-50%, -50%) rotateY(234deg) translateZ(400px); }
.nft-card-3d:nth-child(15) { transform: translate(-50%, -50%) rotateY(252deg) translateZ(400px); }
.nft-card-3d:nth-child(16) { transform: translate(-50%, -50%) rotateY(270deg) translateZ(400px); }
.nft-card-3d:nth-child(17) { transform: translate(-50%, -50%) rotateY(288deg) translateZ(400px); }
.nft-card-3d:nth-child(18) { transform: translate(-50%, -50%) rotateY(306deg) translateZ(400px); }
.nft-card-3d:nth-child(19) { transform: translate(-50%, -50%) rotateY(324deg) translateZ(400px); }
.nft-card-3d:nth-child(20) { transform: translate(-50%, -50%) rotateY(342deg) translateZ(400px); }

/* ==================== STATUS MESSAGE ==================== */
.status-message {
  text-align: center;
  font-size: 16px;
  color: var(--neon-cyan);
  margin-bottom: 20px;
  min-height: 24px;
}

.loading-text {
  animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
</style>
</head>
<body>

<!-- Animated Background -->
<div class="animated-bg"></div>
<div class="grid-overlay"></div>

<!-- Header -->
<div class="header">
  <div class="logo">
    <div class="logo-text">ü¶ä CatKitSune</div>
  </div>
  <div class="nav-actions">
    <button class="login-btn mint-btn" onclick="window.location.href='#mint'">
      üî• Mint
    </button>
    <button class="login-btn" id="walletBtn" onclick="toggleWallet()">
      <img src="https://cdn-icons-png.flaticon.com/512/891/891462.png" style="width:18px;"/>
      <span id="walletText">Connect Wallet</span>
    </button>
    <button class="login-btn" id="twitterBtn" onclick="loginWithTwitter()">
      <img src="https://cdn-icons-png.flaticon.com/512/733/733579.png" style="width:18px;"/>
      Login with Twitter
    </button>
    <div id="twitterAvatar" style="display:none; align-items:center; gap:6px;"></div>
    <div class="avatar"></div>
  </div>
</div>

<!-- Main Content -->
<div class="main-content">
  <h1 class="gallery-title">Hyperliquid NFT Collections</h1>
  
  <!-- Top Navigation -->
  <div class="top-nav">
    <button class="top-nav-btn" onclick="alert('üéÆ Quests coming soon!')">üéÆ</button>
    <button class="top-nav-btn active">üöÄ</button>
    <button class="top-nav-btn" onclick="alert('üíé Staking coming soon!')">üíé</button>
  </div>
  
  <div class="status-message" id="statusMessage"></div>

  <!-- 3D Carousel -->
  <div class="carousel-container">
    <div class="carousel-wrapper" id="carouselWrapper">
      <!-- NFT cards will be dynamically generated here -->
    </div>
  </div>
</div>

<script>
// ==========================================
// NFT COLLECTIONS DATA
// ==========================================
const NFT_COLLECTIONS = [
  { 
    name: 'Wealthy Hypo Babies', 
    address: '0x63eb9d77D083cA10C304E28d5191321977fd0Bfb', 
    image: 'https://pbs.twimg.com/profile_images/1876004126938537984/qpRkjcAX_400x400.jpg'
  },
  { 
    name: 'Tiny Hyper Cats', 
    address: '0xCC3D60fF11a268606C6a57bD6Db74b4208f1D30c', 
    image: 'https://static.drip.trade/collections/tiny-hyper-cat_pfp.jpg'
  },
  { 
    name: 'Hypurr', 
    address: '0x9125E2d6827a00B0F8330D6ef7BEF07730Bac685', 
    image: 'https://static.drip.trade/collections/hypurr_pfp.jpg'
  },
  { 
    name: 'Hyperian Genesis', 
    address: '0xB0F82655F249FC6561A94eB370d41bD24A861A9d', 
    image: 'https://static.drip.trade/collections/hyperian-genesis_pfp.png'
  },
  { 
    name: 'CatKitSune', 
    address: '0x2abF2969E5e9cAAa1D3fF3DF4265dFFcda0D8353', 
    image: 'https://static.drip.trade/collections/catkitsune_pfp.png'
  },
  { 
    name: 'Illumeownati by Catbal', 
    address: '0xDdaB956F9EeE629510B4410627cd63C0448A78aB', 
    image: 'https://static.drip.trade/collections/illumeownati_pfp.png'
  },
  { 
    name: 'PiP & Friends', 
    address: '0xbc4a26ba78ce05E8bCbF069Bbb87FB3E1dAC8DF8', 
    image: 'https://static.drip.trade/collections/pip_pfp.jpg'
  },
  { 
    name: 'Hypers', 
    address: '0x8A3bda085fD13E71FA2851D7a4b4B8af9671c5aB', 
    image: 'https://static.drip.trade/collections/hypers_pfp.png'
  },
  { 
    name: 'Mechacats', 
    address: '0xeA8Cc2a7da4E91c559514B8192eF1cfe1497AC74', 
    image: 'https://static.drip.trade/collections/mechacats_pfp.png'
  },
  { 
    name: 'LQnians', 
    address: '0xfD43e36a9D4002C54a84DAB089a2EdE92ffB5C60', 
    image: 'https://static.drip.trade/collections/lqna_pfp.png'
  },
  { 
    name: 'bald br√∂thers', 
    address: '0x7d87FfB185Fc27Cbee62468A9b5eA00d538b74A6', 
    image: 'https://static.drip.trade/collections/bald-brothers_pfp.png'
  },
  { 
    name: 'BAE', 
    address: '0x31ce9E3Fd78B593c2F37f62AE0fa72A23a2472df', 
    image: 'https://static.drip.trade/collections/bae_pfp.png'
  },
  { 
    name: 'Hypo', 
    address: '0x9583b5632372F50e949361df977464D619b2f826', 
    image: 'https://static.drip.trade/collections/hypo_pfp.png'
  },
  { 
    name: 'Hyperian Legacy', 
    address: '0x05fC042966C40f6cA96e226221B4c699593f4645', 
    image: 'https://static.drip.trade/collections/hyperian-legacy_pfp.png'
  },
  { 
    name: 'Odd Otties', 
    address: '0x43A9652E2B3cE8970e8d33d8C34252a59a6596Aa', 
    image: 'https://static.drip.trade/collections/odd-otties_pfp.png'
  },
  { 
    name: 'Purrtardio', 
    address: '0xa5E817BFF8cAd1aeF7767C5eDFA70F9D267A08aA', 
    image: 'https://static.drip.trade/collections/purrtardio_pfp.png'
  },
  { 
    name: 'Gems', 
    address: '0xDD59aC38cb15F688c18909bA1Ca708A76cC351F5', 
    image: 'https://static.drip.trade/collections/gems_pfp.png'
  },
  { 
    name: 'HyperPunks', 
    address: '0xcB8ff875e8e3e7dbc373171c41946cD8Af5aa00f', 
    image: 'https://static.drip.trade/collections/hyperpunks_pfp.png'
  },
  { 
    name: 'dotHYPE', 
    address: '0xBf7cE65e6E920052C11690a80EAa3ed2fE752Dd8', 
    image: 'https://static.drip.trade/collections/dothype_pfp.jpeg'
  },
  { 
    name: 'Dysto Mfers', 
    address: '0x4C3f38129b171f02167d05E72a2994810b42f2Aa', 
    image: 'https://static.drip.trade/collections/dysto-mfers_pfp.jpg'
  }
];

const HYPERLIQUID_RPC = 'https://rpc.hyperliquid.xyz/evm';
const ERC721_ABI = [
  'function balanceOf(address owner) view returns (uint256)',
  'function tokenURI(uint256 tokenId) view returns (string)',
  'function tokenOfOwnerByIndex(address owner, uint256 index) view returns (uint256)'
];

let walletAddress = null;
let provider = null;

// ==========================================
// INITIALIZE CAROUSEL
// ==========================================
function initializeCarousel() {
  const carousel = document.getElementById('carouselWrapper');
  carousel.innerHTML = '';
  
  NFT_COLLECTIONS.forEach((collection, index) => {
    const card = document.createElement('div');
    card.className = 'nft-card-3d';
    card.dataset.collectionIndex = index;
    
    card.innerHTML = `
      <img src="${collection.image}" alt="${collection.name}" />
      <div class="nft-card-placeholder">
        <div class="placeholder-name">${collection.name}</div>
      </div>
    `;
    
    carousel.appendChild(card);
  });
  
  console.log('‚úÖ Carousel initialized with', NFT_COLLECTIONS.length, 'collections');
}

// ==========================================
// WALLET CONNECTION
// ==========================================
let walletConnected = false;

async function connectWallet() {
  const walletBtn = document.getElementById('walletBtn');
  const walletText = document.getElementById('walletText');
  const statusMsg = document.getElementById('statusMessage');
  
  if (!window.ethereum) {
    alert('ü¶ä Please install MetaMask!\n\nDownload: https://metamask.io');
    window.open('https://metamask.io/download/', '_blank');
    return;
  }
  
  try {
    statusMsg.textContent = 'üîÑ Connecting wallet...';
    
    const accounts = await window.ethereum.request({ 
      method: 'eth_requestAccounts' 
    });
    
    walletAddress = accounts[0];
    walletConnected = true;
    provider = new ethers.providers.Web3Provider(window.ethereum);
    
    walletText.textContent = `${walletAddress.slice(0, 6)}...${walletAddress.slice(-4)}`;
    walletBtn.style.background = 'rgba(139, 92, 246, 0.2)';
    walletBtn.style.borderColor = 'var(--neon-purple)';
    
    statusMsg.innerHTML = '<span class="loading-text">üîç Checking NFT balances...</span>';
    
    // Check NFT balances
    await checkNFTBalances();
    
    statusMsg.textContent = '‚úÖ Wallet connected!';
    setTimeout(() => {
      statusMsg.textContent = '';
    }, 3000);
    
  } catch (error) {
    console.error('‚ùå Wallet connection error:', error);
    statusMsg.textContent = '‚ùå Connection failed!';
  }
}

async function disconnectWallet() {
  walletAddress = null;
  walletConnected = false;
  provider = null;
  
  const walletBtn = document.getElementById('walletBtn');
  const walletText = document.getElementById('walletText');
  
  walletText.textContent = 'Connect Wallet';
  walletBtn.style.background = 'rgba(255, 255, 255, 0.05)';
  walletBtn.style.borderColor = 'rgba(139, 92, 246, 0.3)';
  
  // Reset all cards to placeholder
  initializeCarousel();
  
  console.log('üîå Wallet disconnected');
}

function toggleWallet() {
  if (walletConnected) {
    if (confirm('üîå Disconnect wallet?')) {
      disconnectWallet();
    }
  } else {
    connectWallet();
  }
}

// ==========================================
// TWITTER LOGIN
// ==========================================
function loginWithTwitter() {
  window.location.href = "https://catkitsune.xyz/api/twitter-login";
}

async function loadTwitterUser() {
  const urlParams = new URLSearchParams(window.location.search);
  const name = urlParams.get('name');
  const username = urlParams.get('username');
  const avatar = urlParams.get('avatar');
  
  if (username && avatar) {
    const decodedAvatar = decodeURIComponent(avatar);
    
    const twitterBtn = document.getElementById('twitterBtn');
    const twitterAvatar = document.getElementById('twitterAvatar');
    
    twitterBtn.style.display = 'none';
    twitterAvatar.style.display = 'flex';
    twitterAvatar.innerHTML = `
      <img src="${decodedAvatar}" style="width:24px; height:24px; border-radius:50%;" alt="Twitter Avatar">
      <span style="font-size:12px; font-weight:700;">@${username}</span>
    `;
    
    console.log('‚úÖ Twitter user loaded:', username);
  }
}

// ==========================================
// CHECK NFT BALANCES
// ==========================================
async function checkNFTBalances() {
  if (!walletAddress || !provider) return;
  
  console.log('üîç Checking NFT balances for:', walletAddress);
  
  for (let i = 0; i < NFT_COLLECTIONS.length; i++) {
    const collection = NFT_COLLECTIONS[i];
    
    try {
      const contract = new ethers.Contract(collection.address, ERC721_ABI, provider);
      const balance = await contract.balanceOf(walletAddress);
      
      console.log(`üìä ${collection.name}: ${balance.toString()} NFTs`);
      
      if (balance.gt(0)) {
        // User owns NFTs from this collection
        loadNFTImage(i, collection.image);
      }
      
    } catch (error) {
      console.error(`‚ùå Error checking ${collection.name}:`, error.message);
    }
  }
  
  console.log('‚úÖ Balance check complete!');
}

// ==========================================
// LOAD NFT IMAGE
// ==========================================
function loadNFTImage(cardIndex, imageUrl) {
  const cards = document.querySelectorAll('.nft-card-3d');
  const card = cards[cardIndex];
  
  if (!card) return;
  
  const img = card.querySelector('img');
  const placeholder = card.querySelector('.nft-card-placeholder');
  
  img.onload = function() {
    img.classList.add('loaded');
    placeholder.classList.add('hidden');
    console.log(`‚úÖ Loaded image for card ${cardIndex}`);
  };
  
  img.onerror = function() {
    console.log(`‚ùå Failed to load image for card ${cardIndex}`);
  };
  
  // Trigger load
  img.src = imageUrl;
}

// ==========================================
// INITIALIZE ON LOAD
// ==========================================
window.addEventListener('load', function() {
  console.log('üöÄ NFT Gallery loading...');
  initializeCarousel();
  loadTwitterUser();
  console.log('‚úÖ Ready!');
});

// Listen for account changes
if (window.ethereum) {
  window.ethereum.on('accountsChanged', (accounts) => {
    if (accounts.length === 0) {
      disconnectWallet();
    } else if (walletConnected) {
      walletAddress = accounts[0];
      document.getElementById('walletText').textContent = `${walletAddress.slice(0, 6)}...${walletAddress.slice(-4)}`;
      checkNFTBalances();
    }
  });
}
</script>

</body>
</html>
