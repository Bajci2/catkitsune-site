<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CatKitSune - Mint Your NFT</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .logo {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2em;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .info-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 1.1em;
        }

        .info-label {
            font-weight: bold;
        }

        .wallet-section {
            margin-bottom: 30px;
        }

        .wallet-address {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            word-break: break-all;
            font-family: monospace;
            color: #333;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            width: 100%;
            margin: 10px 0;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .quantity-selector {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }

        .quantity-btn {
            width: 50px;
            height: 50px;
            font-size: 1.5em;
            padding: 0;
            border-radius: 50%;
        }

        .quantity-display {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            min-width: 60px;
        }

        .total-price {
            font-size: 1.5em;
            color: #764ba2;
            font-weight: bold;
            margin: 20px 0;
        }

        .status-message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
        }

        .success {
            background: #d4edda;
            color: #155724;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
        }

        .loading {
            background: #fff3cd;
            color: #856404;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            .subtitle {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="1.png" alt="CatKitSune Logo" class="logo">
        <h1>CatKitSune NFT</h1>
        <p class="subtitle">Mint Your Exclusive NFT</p>

        <div class="info-box">
            <div class="info-item">
                <span class="info-label">Total Supply:</span>
                <span>300</span>
            </div>
            <div class="info-item">
                <span class="info-label">Available:</span>
                <span id="available">300</span>
            </div>
            <div class="info-item">
                <span class="info-label">Price:</span>
                <span>0.5 HYPE</span>
            </div>
        </div>

        <div class="wallet-section">
            <button id="connectWallet">Connect Wallet</button>
            <div id="walletInfo" style="display: none;">
                <div class="wallet-address" id="walletAddress"></div>
            </div>
        </div>

        <div id="mintSection" style="display: none;">
            <div class="quantity-selector">
                <button class="quantity-btn" id="decreaseBtn">-</button>
                <span class="quantity-display" id="quantity">1</span>
                <button class="quantity-btn" id="increaseBtn">+</button>
            </div>
            <div class="total-price">
                Total: <span id="totalPrice">0.5</span> HYPE
            </div>
            <button id="mintBtn">Mint NFT</button>
        </div>

        <div id="statusMessage"></div>
    </div>

    <script type="module">
        const MODE = "TEST"; // TEST | LIVE
        
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js';
        import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js';

        // Firebase konfigur√°ci√≥
        const firebaseConfig = {
            apiKey: "AIzaSyCn99m_Ylo5In_eram3HHol-AV9d2MdnNs",
            authDomain: "catkitsune-d2acc.firebaseapp.com",
            databaseURL: "https://catkitsune-d2acc-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "catkitsune-d2acc",
            storageBucket: "catkitsune-d2acc.firebasestorage.app",
            messagingSenderId: "21305297418",
            appId: "1:21305297418:web:4d2a83d9a7a9f49ea49bb7",
            measurementId: "G-58Z7Z4DZN0"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Smart contract konfigur√°ci√≥
        const CONTRACT_ADDRESS = "0x..."; // IDE KER√úL A CONTRACT C√çM
        const PRICE_PER_NFT = "0.5"; // HYPE
        const MAX_SUPPLY = 300;

        let currentAccount = null;
        let quantity = 1;
        const PRICE = 0.5;

        // Firebase listener - el√©rhet≈ë NFT-k sz√°ma
        const availableRef = ref(database, 'nft/available');
        onValue(availableRef, (snapshot) => {
            const available = snapshot.val() || MAX_SUPPLY;
            document.getElementById('available').textContent = available;
        });

        // Wallet csatlakoztat√°s
        document.getElementById('connectWallet').addEventListener('click', async () => {
            if (typeof window.ethereum === 'undefined') {
                showStatus('Please install MetaMask!', 'error');
                return;
            }

            try {
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });

                // TEST MODE ellen≈ërz√©s
                if (MODE === "TEST") {
                    console.log("üß™ TEST MODE: Wallet csatlakoztatva:", accounts[0]);
                    alert("üß™ TEST MODE: Wallet sikeresen csatlakoztatva!\n\nC√≠m: " + accounts[0] + "\n\n‚ö†Ô∏è Tranzakci√≥k NEM ker√ºlnek elk√ºld√©sre!");
                    currentAccount = accounts[0];
                    document.getElementById('walletAddress').textContent = currentAccount;
                    document.getElementById('walletInfo').style.display = 'block';
                    document.getElementById('connectWallet').style.display = 'none';
                    document.getElementById('mintSection').style.display = 'block';
                    showStatus('TEST MODE: Wallet connected - No real transactions will be sent', 'loading');
                    return;
                }

                currentAccount = accounts[0];
                document.getElementById('walletAddress').textContent = currentAccount;
                document.getElementById('walletInfo').style.display = 'block';
                document.getElementById('connectWallet').style.display = 'none';
                document.getElementById('mintSection').style.display = 'block';
                showStatus('Wallet connected successfully!', 'success');
            } catch (error) {
                showStatus('Failed to connect wallet: ' + error.message, 'error');
            }
        });

        // Mennyis√©g kezel√©se
        document.getElementById('decreaseBtn').addEventListener('click', () => {
            if (quantity > 1) {
                quantity--;
                updateQuantityDisplay();
            }
        });

        document.getElementById('increaseBtn').addEventListener('click', () => {
            const available = parseInt(document.getElementById('available').textContent);
            if (quantity < Math.min(10, available)) {
                quantity++;
                updateQuantityDisplay();
            }
        });

        function updateQuantityDisplay() {
            document.getElementById('quantity').textContent = quantity;
            document.getElementById('totalPrice').textContent = (PRICE * quantity).toFixed(1);
        }

        // Minting
        document.getElementById('mintBtn').addEventListener('click', async () => {
            if (!currentAccount) {
                showStatus('Please connect your wallet first!', 'error');
                return;
            }

            // TEST MODE ellen≈ërz√©s
            if (MODE === "TEST") {
                console.log("üß™ TEST MODE: Mint gomb megnyomva");
                console.log("Mennyis√©g:", quantity);
                console.log("√ñssz √°r:", (PRICE * quantity).toFixed(1), "HYPE");
                alert("üß™ TEST MODE: Tranzakci√≥ NEM ker√ºlt elk√ºld√©sre!\n\nMennyis√©g: " + quantity + "\n√ñssz √°r: " + (PRICE * quantity).toFixed(1) + " HYPE\n\n‚úÖ Wallet m≈±k√∂dik!\n‚ö†Ô∏è √âles m√≥dban ez val√≥di tranzakci√≥ lenne.");
                showStatus('TEST MODE: Transaction simulated successfully!', 'success');
                return;
            }

            try {
                showStatus('Processing mint...', 'loading');

                const totalPrice = (PRICE * quantity).toString();
                const valueInWei = window.ethereum.utils.toWei(totalPrice, 'ether');

                // Smart contract h√≠v√°s
                const transactionParameters = {
                    to: CONTRACT_ADDRESS,
                    from: currentAccount,
                    value: valueInWei,
                    data: '0x' // Ide ker√ºl a contract function call
                };

                const txHash = await window.ethereum.request({
                    method: 'eth_sendTransaction',
                    params: [transactionParameters],
                });

                showStatus('Minting successful! Transaction: ' + txHash, 'success');
            } catch (error) {
                showStatus('Minting failed: ' + error.message, 'error');
            }
        });

        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = 'status-message ' + type;
            statusDiv.style.display = 'block';
        }
    </script>
</body>
</html>
