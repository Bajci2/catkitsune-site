<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CatKitSune ‚Äì Mint</title>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.card {
  background: #020617;
  padding: 30px;
  border-radius: 16px;
  width: 360px;
  text-align: center;
}
button {
  width: 100%;
  padding: 15px;
  margin-top: 15px;
  font-size: 18px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
}
#mintBtn {
  background: #22c55e;
  color: black;
}
#connectBtn {
  background: #38bdf8;
  color: black;
}
input {
  width: 100%;
  padding: 10px;
  font-size: 18px;
  text-align: center;
  border-radius: 8px;
  border: none;
  margin-top: 10px;
}
</style>
</head>

<body>
<div class="card">
  <h2>üê± CatKitSune Mint</h2>
  <p>Price: <b>0.3 HYPE</b></p>

  <input id="qty" type="number" min="1" value="1" />

  <button id="connectBtn" onclick="connect()">Connect Wallet</button>
  <button id="mintBtn" onclick="mint()" disabled>Mint NFT</button>

  <p id="status"></p>
</div>

<script>
/* ================= CONFIG ================= */

const CONTRACT_ADDRESS = "0xe428ADb731D5fd4E5a117C85059828d894683E78";
const PRICE = "0.3";
const CHAIN_ID = "0x3e7"; // HyperEVM Mainnet

const ABI = [
  "function publicMint(uint256 quantity) payable",
  "function totalMinted() view returns (uint256)"
];

/* ========================================= */

let provider, signer, contract;

async function connect() {
  if (!window.ethereum) {
    alert("MetaMask required");
    return;
  }

  await window.ethereum.request({
    method: "wallet_switchEthereumChain",
    params: [{ chainId: CHAIN_ID }]
  });

  provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts", []);
  signer = provider.getSigner();

  contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);

  document.getElementById("connectBtn").innerText = "Wallet Connected";
  document.getElementById("mintBtn").disabled = false;
}

async function mint() {
  const qty = Number(document.getElementById("qty").value);
  if (qty < 1) return;

  const value = ethers.utils.parseEther(
    (Number(PRICE) * qty).toString()
  );

  try {
    document.getElementById("status").innerText = "Minting...";
    const tx = await contract.publicMint(qty, { value });
    await tx.wait();
    document.getElementById("status").innerText = "‚úÖ Mint successful";
  } catch (e) {
    console.error(e);
    document.getElementById("status").innerText = "‚ùå Mint failed";
  }
}
</script>
</body>
</html>
